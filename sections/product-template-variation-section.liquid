{%- capture section_settings -%}
{
  "enableHistoryState": true,
  "templateSuffix": {{ product.template_suffix | json }},
  "showInventoryQuantity": {{ section.settings.show_inventory_quantity | json }},
  "showSku": {{ section.settings.show_sku | json }},
  "stackProductImages": {{ section.settings.stack_images | json }},
  "showThumbnails": {{ section.settings.show_thumbnails | json }},
  "inventoryQuantityThreshold": {{ section.settings.inventory_quantity_threshold }},
  "showPriceInButton": {{ section.settings.show_price_in_button | json }},
  "enableImageZoom": {{ section.settings.enable_image_zoom | json }},
  "showPaymentButton": {{ section.settings.show_payment_button | json }},
  "useAjaxCart": {% if settings.cart_type == 'drawer' %}true{% else %}false{% endif %}
}
{%- endcapture -%}
{%- assign dcTitle = product.title | downcase -%}
<style>
  .ProductForm__QuantitySelector h2 {
      margin-top: 12px !important;
  }
</style>
<section class="Product Product--{{ section.settings.image_size }}" data-section-id="{{ section.id }}" data-section-type="product" data-section-settings='{{ section_settings }}'>
  <div class="Product__Wrapper">
    {%- capture action_list_items -%}
      {%- if section.settings.enable_image_zoom -%}
        <div class="Product__ActionItem hidden-lap-and-up">
          <button class="RoundButton RoundButton--small RoundButton--flat" data-action="open-product-zoom">{% include 'icon' with 'plus' %}</button>
        </div>
      {%- endif -%}

      {%- if section.settings.show_share_buttons -%}
        <div class="Product__ActionItem hidden-lap-and-up">
          <button class="RoundButton RoundButton--small RoundButton--flat" data-action="toggle-social-share" data-animate-bottom aria-expanded="false">
            <span class="RoundButton__PrimaryState">{% include 'icon' with 'share' %}</span>
            <span class="RoundButton__SecondaryState">{% include 'icon' with 'close' %}</span>
          </button>

          {%- assign share_url = shop.url | append: product.url -%}
          {%- assign twitter_text = product.title -%}
          {%- assign pinterest_description = product.description | strip_html | truncatewords: 15 | url_param_escape -%}
          {%- assign pinterest_image = product.featured_image | img_url: 'large' | prepend: 'https:' -%}

          <div class="Product__ShareList" aria-hidden="true">
            <a class="Product__ShareItem" href="https://www.facebook.com/sharer.php?u={{ share_url }}" target="_blank" rel="noopener">{%- include 'icon' with 'facebook' -%} Facebook</a>
            <a class="Product__ShareItem" href="https://pinterest.com/pin/create/button/?url={{ share_url }}{% if pinterest_image != blank %}&media={{ pinterest_image }}{% endif %}&description={{ pinterest_description }}" target="_blank" rel="noopener">{%- include 'icon' with 'pinterest' -%} Pinterest</a>
            <a class="Product__ShareItem" href="https://twitter.com/share?{% if twitter_text != blank %}text={{twitter_text}}&{% endif %}url={{ share_url }}" target="_blank" rel="noopener">{%- include 'icon' with 'twitter' -%} Twitter</a>
          </div>
        </div>
      {%- endif -%}
    {%- endcapture -%}

    {%- comment -%}
    --------------------------------------------------------------------------------------------------------------------
    PRODUCT GALLERY
    --------------------------------------------------------------------------------------------------------------------
    {%- endcomment -%}

    {%- assign initial_image_id = product.featured_image.id -%}
    {%- assign initial_image_index = 0 -%}
    {%- assign image_count = 0 -%}

    {%- capture slideshow_images -%}
      {%- for image in product.images -%}
        {%- if image.alt == 'featured' or image.alt == 'featured mobile' -%}
          {%- continue -%}
        {%- endif -%}

        {%- if image.id == product.selected_or_first_available_variant.image.id -%}
          {%- assign initial_image_index = image_count -%}
          {%- assign initial_image_id = image.id -%}
        {%- endif -%}

        {%- include 'image-size', sizes: '200,400,600,700,800,900,1000,1200,1400,1600', image: image -%}

        {%- assign is_video = false -%}

        {%- if image.alt contains 'youtube.com/embed' or image.alt contains 'player.vimeo.com' -%}
          {%- assign is_video = true -%}
        {%- endif -%}

        <div id="Image{{ image.id }}" class="Product__SlideItem Product__SlideItem--{% if is_video %}video{% else %}image{% endif %} Carousel__Cell {% if initial_image_id == image.id %}is-selected{% endif %}"
             {% if is_video %}data-action="open-modal" aria-controls="modal-video-{{ image.id }}"{% endif %}
             {% unless is_video %}data-image-position-ignoring-video="{% increment image_position_without_video %}"{% endunless %}
             data-image-position="{% increment image_position %}"
             data-image-id="{{ image.id }}">
          <div class="AspectRatio AspectRatio--withFallback" style="padding-bottom: {{ 100.0 | divided_by: image.aspect_ratio }}%; --aspect-ratio: {{ image.aspect_ratio }};">
            {% assign image_url = image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' %}

            <img class="Image--lazyLoad Image--fadeIn"
                 {% if initial_image_id == image.id %}src="{{ image | img_url: '250x' }}"{% endif %}
                 data-src="{{ image_url }}"
                 data-widths="[{{ supported_sizes }}]"
                 data-sizes="auto"
                 data-expand="-100"
                 alt="{{ image.alt | escape }}"
                 data-max-width="{{ image.width }}"
                 data-max-height="{{ image.height }}"
                 data-original-src="{{ image | img_url: 'master' }}">

            <span class="Image__Loader"></span>

            {%- if is_video -%}
              <button type="button" class="Video__PlayButton" aria-label="{{ 'home_page.featured_video.play' | t }}">{% include 'icon' with 'play' %}</button>
            {%- endif -%}

            <noscript>
              <img src="{{ image | img_url: '800x' }}" alt="{{ image.alt | escape }}">
            </noscript>
          </div>
        </div>

        {%- assign image_count = image_count | plus: 1 -%}
      {%- endfor -%}
    {%- endcapture -%}

    {%- if product.images.size > 0 -%}
      <div class="Product__Gallery {% if section.settings.stack_images %}Product__Gallery--stack{% endif %} {% if section.settings.show_thumbnails and image_count > 1 %}Product__Gallery--withThumbnails{% else %}Product__Gallery--withDots{% endif %}">
        <span id="ProductGallery" class="Anchor"></span>

        {%- if action_list_items != blank -%}
          <div class="Product__ActionList hidden-lap-and-up">
          {{ action_list_items }}
          </div>
        {%- endif -%}

        {%- capture slideshow_nav -%}
          {%- if image_count > 1 -%}
            {%- if section.settings.show_thumbnails -%}
              <div class="Product__SlideshowNav Product__SlideshowNav--thumbnails">
                <div class="Product__SlideshowNavScroller">
                  {%- for image in product.images -%}
                    {%- if image.alt == 'featured' or image.alt == 'featured mobile' -%}
                      {%- continue -%}
                    {%- endif -%}

                    {%- assign is_video = false -%}

                    {%- if image.alt contains 'youtube.com/embed' or image.alt contains 'player.vimeo.com' -%}
                      {%- assign is_video = true -%}
                    {%- endif -%}

                    {%- if section.settings.stack_images -%}
                      <a href="#Image{{ image.id }}" data-image-id="{{ image.id }}" class="Product__SlideshowNavImage {% if is_video %}Product__SlideshowNavImage--video{% endif %} AspectRatio {% if forloop.first %}is-selected{% endif %}" style="--aspect-ratio: {{ image.aspect_ratio }}">
                        <img src="{{ image | img_url: '160x' }}">

                        {%- if is_video -%}
                          <button type="button" class="Product__SlideshowNavPlay" data-action="play-video" aria-label="{{ 'home_page.featured_video.play' | t }}">{% include 'icon' with 'play' %}</button>
                        {%- endif -%}
                      </a>
                    {%- else -%}
                      <span data-image-id="{{ image.id }}" class="Product__SlideshowNavImage {% if is_video %}Product__SlideshowNavImage--video{% endif %} AspectRatio {% if forloop.first %}is-selected{% endif %}" style="--aspect-ratio: {{ image.aspect_ratio }}">
                        <img src="{{ image | img_url: '160x' }}">

                        {%- if is_video -%}
                          <button type="button" class="Product__SlideshowNavPlay" data-action="play-video" aria-label="{{ 'home_page.featured_video.play' | t }}">{% include 'icon' with 'play' %}</button>
                        {%- endif -%}
                      </span>
                    {%- endif -%}
                  {%- endfor -%}
                </div>
              </div>
            {%- endif -%}

            {%- if section.settings.stack_images -%}
              <div class="Product__SlideshowNav Product__SlideshowNav--dots">
                <div class="Product__SlideshowNavScroller">
                  {%- for image in product.images -%}
                    {%- if image.alt == 'featured' or image.alt == 'featured mobile' -%}
                      {%- continue -%}
                    {%- endif -%}

                    <a href="#Image{{ image.id }}" class="Product__SlideshowNavDot {% if forloop.first %}is-selected{% endif %}"></a>
                  {%- endfor -%}
                </div>
              </div>
            {%- endif -%}
          {%- endif -%}
        {%- endcapture -%}

        {%- if section.settings.stack_images -%}
          {{- slideshow_nav -}}
        {%- endif -%}

        {%- capture flickity_options -%}
        {
          "prevNextButtons": false,
          "pageDots": {% if image_count > 1 %}true{% else %}false{% endif %},
          "adaptiveHeight": true,
          "watchCSS": true,
          "dragThreshold": 8,
          "initialIndex": {{ initial_image_index }},
          "arrowShape": {"x0": 20, "x1": 60, "y1": 40, "x2": 60, "y2": 35, "x3": 25}
        }
        {%- endcapture -%}

        <div class="Product__Slideshow {% if section.settings.enable_image_zoom %}Product__Slideshow--zoomable{% endif %} Carousel" data-flickity-config='{{ flickity_options }}'>
          {{ slideshow_images }}
        </div>

        {%- unless section.settings.stack_images -%}
          {{- slideshow_nav -}}
        {%- endunless -%}
      </div>
    {%- endif -%}

    {%- capture product_aside -%}
      {%- comment -%}
      --------------------------------------------------------------------------------------------------------------------
      PRODUCT TABS
      --------------------------------------------------------------------------------------------------------------------
      {%- endcomment -%}

      {%- include 'product-tabs' -%}

      {%- comment -%}
      --------------------------------------------------------------------------------------------------------------------
      PRODUCT WEAR IT WITH

      We allow merchants to add a tag that looks like __with:product-handle to feature an additional product
      --------------------------------------------------------------------------------------------------------------------
      {%- endcomment -%}

      {%- for tag in product.tags -%}
        {%- if tag contains '__with' -%}
          {%- assign product_handle = tag | split: '__with:' | last -%}
          {%- assign associated_product = all_products[product_handle] -%}

          {%- if associated_product != empty -%}
            <div class="Section Section--spacingNormal">
              <header class="SectionHeader SectionHeader--center">
                <h3 class="SectionHeader__Heading Heading u-h4">{{ 'product.buy_it_with.title' | t }}</h3>
              </header>

              {% include 'product-item', product: associated_product, use_horizontal: true, show_labels: false, show_product_info: true, show_vendor: false, show_price_on_hover: false %}
            </div>

            {%- break -%}
          {%- endif -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endcapture -%}

    <div class="Product__InfoWrapper">
      <div class="Product__Info {% if image_count == 0 %}Product__Info--noGallery{% endif %}">
        <div class="Container">
          {%- include 'product-meta', show_description: true -%}

          {%- if product.template_suffix != 'coming-soon' -%}
            {%- include 'product-form-variants' -%}
          {%- endif -%}

          {%- if section.settings.description_below_add_to_cart -%}
            <div class="ProductMeta__Description">
              <div class="Rte">
                {{ product.description }}
              </div>

              {%- if section.settings.show_share_buttons -%}
                <div class="ProductMeta__ShareButtons hidden-pocket">
                  <span class="ProductMeta__ShareTitle Heading Text--subdued u-h7">{{ 'product.form.share' | t }}</span>

                  {%- assign share_url = shop.url | append: product.url -%}
                  {%- assign twitter_text = product.title -%}
                  {%- assign pinterest_description = product.description | strip_html | truncatewords: 15 | url_param_escape -%}
                  {%- assign pinterest_image = product.featured_image | img_url: 'large' | prepend: 'https:' -%}

                  <div class="ProductMeta__ShareList Text--subdued">
                    <a class="ProductMeta__ShareItem" href="https://www.facebook.com/sharer.php?u={{ share_url }}" target="_blank" rel="noopener" aria-label="Facebook">{%- include 'icon' with 'facebook' -%}</a>
                    <a class="ProductMeta__ShareItem" href="https://twitter.com/share?{% if twitter_text != blank %}text={{twitter_text}}&{% endif %}url={{ share_url }}" target="_blank" rel="noopener" aria-label="Twitter">{%- include 'icon' with 'twitter' -%}</a>
                    <a class="ProductMeta__ShareItem" href="https://pinterest.com/pin/create/button/?url={{ share_url }}{% if pinterest_image != blank %}&media={{ pinterest_image }}{% endif %}&description={{ pinterest_description }}" target="_blank" rel="noopener" aria-label="Pinterest">{%- include 'icon' with 'pinterest' -%}</a>
                  </div>
                </div>
              {%- endif -%}
            </div>
          {%- endif -%}

          {%- if product_aside != blank and image_count > 0 -%}
            <div class="Product__QuickNav hidden-pocket">
              <div class="Product__QuickNavWrapper">
                <a href="#ProductAside" class="Heading Link Link--secondary u-h7">{{ 'product.form.view_info' | t }} {% include 'icon' with 'select-arrow-right' %}</a>
                <a href="#ProductGallery" class="Heading Link Link--secondary u-h7">{{ 'product.form.view_images' | t }} {% include 'icon' with 'select-arrow-right' %}</a>
              </div>
            </div>
          {%- endif -%}
        </div>
      </div>

      {%- if action_list_items != blank -%}
        <div class="Product__ActionList hidden-pocket">
          {{ action_list_items }}
        </div>
      {%- endif -%}
    </div>

    {%- if product_aside != blank -%}
      <div class="Product__Aside">
        <span id="ProductAside" class="Anchor"></span>
        {{- product_aside -}}
      </div>
    {%- endif -%}
  </div>

  {%- comment -%}
  --------------------------------------------------------------------------------------------------------------------
  OFF SCREEN ELEMENTS
  --------------------------------------------------------------------------------------------------------------------
  {%- endcomment -%}

  {{- product_popovers -}}
  {{- product_modals -}}
</section>



{%- if dcTitle == "ellis old fashioned" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make an Ellis Old Fashioned</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/428240874?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "agave margarita" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make an Agave Margarita</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/429343137?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "hey girl" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make a cocktail with Hey Girl</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/429341742?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "bouquet" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make a cocktail with Bouquet</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/429332661?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "sweaterweather" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make a cocktail with #sweaterweather</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/428248788?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "jackass" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make a cocktail with Jackass</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/429342354?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}
{%- if dcTitle == "honey sour" -%}
<section  class="Product Product--{{ section.settings.image_size }}">
  <div class="container" style="text-align:center;">
    <h3 class="Heading u-h2">How to make a cocktail with Jackass</h3>
    <section class="Section" data-section-type="background-video">
    <div class="ImageHero" data-vimeo-initialized="true">
    <div class="ImageHero__VideoHolder">
  <iframe src="https://player.vimeo.com/video/429333824?app_id=122963&portrait=false&title=false&playsinline=false&byline=false&loop=true" width="640" height="360" frameborder="0" allow="fullscreen" allowfullscreen="" title="Old Fashioned" data-ready="true"></iframe>
      </div>
      </div>
    </section>
  </div>  
</section>
{%- endif -%}


{%- comment -%}
--------------------------------------------------------------------------------------------------------------------
FEATURED IMAGE

We allow merchants to use one image as a "featured image" by adding the alt tag "featured"
--------------------------------------------------------------------------------------------------------------------
{%- endcomment -%}

{%- for image in product.images -%}
  {%- if image.alt == 'featured' -%}
    {%- assign desk_featured_image = image -%}
  {%- endif -%}

  {%- if image.alt == 'featured mobile' -%}
    {%- assign mobile_featured_image = image -%}
  {%- endif -%}
{%- endfor -%}

{%- if desk_featured_image or mobile_featured_image -%}
  {%- assign mobile_featured_image = mobile_featured_image | default: desk_featured_image -%}
  {%- assign desk_featured_image = desk_featured_image | default: mobile_featured_image -%}

  <div class="Product__FeatureImageWrapper" style="background: url({{ desk_featured_image | img_url: '1x1', format: 'jpg' }})">
    <div class="Product__FeatureImage Product__FeatureImage--{{ section.settings.featured_image_size }} Image--lazyLoad Image--zoomOut hide-no-js" data-expand="-25" data-bgset="{{ mobile_featured_image | img_url: 'x850' }} [(max-width: 640px)] | {{ desk_featured_image | img_url: '1500x' }}"></div>

    <noscript>
      <div class="Product__FeatureImage Product__FeatureImage--{{ section.settings.featured_image_size }}" style="background-image: url({{ desk_featured_image | img_url: '1500x' }})"></div>
    </noscript>
  </div>

  <style>
    #shopify-section-{{ section.id }} + .shopify-section--bordered {
      border-top: 0;
    }
  </style>

{%- else -%}
  <style>
    /* Very ugly haha */

    @media screen and (max-width: 640px) {
      #shopify-section-{{ section.id }} + .shopify-section--bordered {
        border-top: 0;
      }

      #shopify-section-{{ section.id }} + .shopify-section--bordered > .Section {
        padding-top: 0;
      }
    }
  </style>
{%- endif -%}

{%- comment -%}
--------------------------------------------------------------------------------------------------------------------
MODALS

If we have some videos, we implement them as modal
--------------------------------------------------------------------------------------------------------------------
{%- endcomment -%}

{%- for image in product.images -%}
  {%- if image.alt contains 'youtube.com/embed' or image.alt contains 'player.vimeo.com' -%}
    <div id="modal-video-{{ image.id }}" class="Modal Modal--fullScreen Modal--videoContent" aria-hidden="true" role="dialog" data-scrollable>
      <div class="Modal__Content">
        <div class="Container Container--narrow">
          <div class="VideoWrapper">
            {% if image.alt contains 'youtube.com/embed' %}
              <iframe class="Image--lazyLoad" data-src="{{ image.alt }}?autoplay=1&showinfo=0&controls=1&rel=0&modestbranding=1" frameborder="0" allowfullscreen></iframe>
            {% else %}
              <iframe class="Image--lazyLoad" data-src="{{ image.alt }}?autoplay=1&portrait=0&byline=0&color={{ settings.accent_color | remove_first: '#' }}" frameborder="0"></iframe>
            {% endif %}
          </div>
        </div>
      </div>

      <button class="Modal__Close Modal__Close--outside" data-animate-bottom data-action="close-modal">{% include 'icon' with 'close' %}</button>
    </div>
  {%- endif -%}
{%- endfor -%}

{%- comment -%}
--------------------------------------------------------------------------------------------------------------------
PHOTO SWIPE

This is the root container for the zoom functionality. Must not be removed, as order element is important.
--------------------------------------------------------------------------------------------------------------------
{%- endcomment -%}

{%- if section.settings.enable_image_zoom -%}
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides. Do not remove as content is dynamically added -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Main UI bar -->
      <div class="pswp__ui pswp__ui--hidden">
        <button class="pswp__button pswp__button--prev RoundButton" data-animate-left title="{{ 'product.slideshow.previous' | t }}">{% include 'icon' with 'arrow-left' %}</button>
        <button class="pswp__button pswp__button--close RoundButton RoundButton--large" data-animate-bottom title="{{ 'product.slideshow.close' | t }}">{% include 'icon' with 'close' %}</button>
        <button class="pswp__button pswp__button--next RoundButton" data-animate-right title="{{ 'product.slideshow.next' | t }}">{% include 'icon' with 'arrow-right' %}</button>
      </div>
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "Product page",
  "class": "shopify-section--bordered",
  "settings": [
    {
        "type": "color",
        "id": "branding_color",
        "label": "Branding color",
        "info": "Select branding color for this product"
    },
    {
        "type": "image_picker",
        "id": "flavors_icon",
        "label": "Flavors Icon"
    },
    {
      "type": "checkbox",
      "id": "show_share_buttons",
      "label": "Show social sharing buttons",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_sku",
      "label": "Show SKU",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "description_below_add_to_cart",
      "label": "Description below add to cart",
      "default": false
    },
    {
      "type": "select",
      "id": "selector_mode",
      "label": "Selector type",
      "options": [
        {
          "value": "block",
          "label": "Block"
        },
        {
          "value": "dropdown",
          "label": "Dropdown"
        }
      ],
      "default": "dropdown"
    },
    {
      "type": "checkbox",
      "id": "show_color_swatch",
      "label": "Show color swatch",
      "default": false,
      "info": "Some colors appear white? [Learn more](http://support.maestrooo.com/article/80-product-uploading-custom-color-for-color-swatch)."
    },
    {
      "type": "checkbox",
      "id": "show_color_carousel",
      "label": "Show color carousel",
      "info": "A pop-up selector with variant images for choosing colors. Only enables when color swatch is disabled.",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_quantity_selector",
      "label": "Show quantity selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_inventory_quantity",
      "label": "Show inventory quantity",
      "info": "Make sure that your inventory is tracked. [Learn more](https://help.shopify.com/manual/products/inventory#set-up-inventory-tracking).",
      "default": false
    },
    {
      "type": "range",
      "id": "inventory_quantity_threshold",
      "label": "Inventory quantity threshold",
      "info": "Only show inventory quantity if below threshold. Choose 0 to always show.",
      "min": 0,
      "max": 50,
      "step": 1,
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "show_price_in_button",
      "label": "Show price in add to cart button",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_payment_button",
      "label": "Show dynamic checkout button",
      "info": "Each customer will see their preferred payment method from those available on your store, such as PayPal or Apple Pay. [Learn more](https://help.shopify.com/manual/using-themes/change-the-layout/dynamic-checkout)",
      "default": true
    },
    {
      "type": "header",
      "content": "Product images"
    },
    {
      "type": "select",
      "id": "image_size",
      "label": "Size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        },
        {
          "value": "fill",
          "label": "Fill screen"
        }
      ],
      "default": "large"
    },
    {
      "type": "checkbox",
      "id": "stack_images",
      "label": "Stack images on desktop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_thumbnails",
      "label": "Show thumbnails on desktop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_image_zoom",
      "label": "Enable zoom",
      "default": true
    },
    {
      "type": "header",
      "content": "Tabs"
    },
    {
      "type": "page",
      "id": "tab_page_1_handle",
      "label": "First page"
    },
    {
      "type": "page",
      "id": "tab_page_2_handle",
      "label": "Second page"
    },
    {
      "type": "paragraph",
      "content": "The theme also allows you to add specific tabs for a given product only. [Learn more about this feature](http://support.maestrooo.com/article/83-product-adding-different-tabs-per-product)."
    },
    {
      "type": "header",
      "content": "Reviews"
    },
    {
      "type": "paragraph",
      "content": "You need to install [Shopify's free Product Reviews](https://apps.shopify.com/product-reviews) app before enabling this option."
    },
    {
      "type": "checkbox",
      "id": "reviews_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "header",
      "content": "Featured image"
    },
    {
      "type": "paragraph",
      "content": "You can highlight an image after product tabs by adding the ALT tag \"featured\" to a given image. [Learn more](http://support.maestrooo.com/article/152-product-highlight-a-featured-image)."
    },
    {
      "type": "select",
      "id": "featured_image_size",
      "label": "Section size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "normal",
          "label": "Normal"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "large"
    }
  ],
  "blocks": [
      {
          "type": "product_objects",
          "name": "Product variation",
          "settings": [
              {
                  "type": "color",
                  "id": "color",
                  "label": "Color",
                  "info": "Select branding color"
              },
              {
                      "type": "product",
                      "id": "product",
                      "label": "Product",
                      "info": "Select the product you want to associate"
              },
                {
                    "type": "image_picker",
                    "id": "flavors_icon",
                    "label": "Flavors Icon"
                }
          ]
      }
  ]
  
}
{% endschema %}
<script>
    //Things
    let productTitle = document.querySelector('.ProductMeta__Title');
    let productVariants = document.querySelectorAll('[data-handle]');
    let productPrice = document.querySelector('.ProductMeta__Price.Price');
    let quantityButtons = document.querySelectorAll('.QuantitySelector__Button');
    let quantityValue = document.querySelector('.QuantitySelector__CurrentQuantity');
    let productBuyButton = document.querySelector('button.ProductForm__AddToCart');
    let productDescriptionContainer = document.querySelector('.ProductMeta__Description');
  	let productImagesContainer = document.querySelector('.flickity-slider');
    let flavorTitle = document.querySelector('.flavor-title');
  	setTimeout(function(){ productImagesContainer = document.querySelector('.flickity-slider'); }, 2500);

	let sectionContainer = document.querySelector('.Product__Wrapper');

    //Data
    //Product ID
    //Data SKU
    //Value
    const variantId = document.querySelector('.ProductForm__Variants input[type=hidden]');
    const supportedSizes = [{{supported_sizes}}];
    //const play = {{home_page.featured_video.play | t }} || "play"; 


    //Functions

    function manageProductVariants(e){
		fetch(`/products/${e.target.closest('button').dataset.handle}?view=subscription`)
        .then((function(t) {
          return t.text()
        })).then((function(t) {
          document.getElementById("subscription_append").innerHTML = t;
          if($("#first_group").length > 0) {
            setTimeout(function(){ $('#first_group').trigger('click'); }, 500);
          }
        }));

         fetch(`/products/${e.target.closest('button').dataset.handle}.js`)
        .then(response => response.json())
        .then(product => {
            updateProductImages(product);
            updateProductInfo(product);
            updateProductVariation(product);
           	updateProductUrl(product);
           	updateProductReview(product);
        });

      
    }

    function updateProductInfo(product){
       //Disable quantity and add to cart buttons if product not available
       if(!product.available){
           quantityValue.style.color = "#e1e1e1";
           quantityValue.value = 0;
           quantityButtons.forEach(button => {
               button.style.pointerEvents = "none";
               button.style.color = "#e1e1e1";
           });
           productBuyButton.style.pointerEvents = "none";
           productBuyButton.setAttribute("disabled", "disabled");
       }else{
           quantityButtons.forEach(button => {
               button.style.pointerEvents = "unset";
               productBuyButton.style.pointerEvents = "unset";
           });
           
           
       }
       productTitle.innerHTML = product.title;
       productDescriptionContainer.innerHTML = product.description;
       productPrice.innerHTML = `$${product.price / 100}`;
       flavorTitle.innerHTML = product.title;
    }

    let  image_position_without_video = 0;
    let image_position = 0;
	
  	
  	
    function updateProductImages(product){

        productImagesContainer.innerHTML = "";
		let count = 0;
      	let sl = '';
       product.media.forEach((mediaItem, index) => {

                let initial_image_index = mediaItem.length;
                let initial_image_id = mediaItem.id;

                
                if(count==0){
                  sl = 'is-selected';
                }else{
                  sl = '';
                }
                let is_video = false;

                /*if(mediaItem.alt != null){
                    if(mediaItem.alt.contains('youtube.com/embed')  || mediaItem.alt.contains('player.vimeo.com')){
                        let is_video = true
                    }
                }*/
                const imageSrc = editImgURL(mediaItem.src, '1024');

                let initialImageIdSource = editImgURL(mediaItem.src, '250');


                productImagesContainer.innerHTML += `
                    <div id="Image${mediaItem.id }" class="Product__SlideItem Product__SlideItem--${is_video ? 'video' : 'image'} Carousel__Cell ${ sl }"
                            ${is_video ? 'data-action="open-modal" aria-controls="modal-video-' + mediaItem.id : ''}
                            ${!is_video ? 'data-image-position-ignoring-video="' + image_position + '"' : ''}
                            data-image-position="${image_position}"
                            data-image-id="${ mediaItem.id }" style="position: absolute; left: ${count}%;">
                        <div class="AspectRatio AspectRatio--withFallback" style="padding-bottom:${mediaItem.aspect_ratio / 100}; --aspect-ratio: ${mediaItem.aspect_ratio};">

                            <img class="Image--lazyLoad Image--fadeIn"
                                src="${imageSrc}" 
                                data-src="${imageSrc}" 
                                data-widths="[${supportedSizes}]" 
                                data-sizes="auto" 
                                data-expand="-100" 
                                alt="${mediaItem.alt}" 
                                data-max-width="${mediaItem.width}" 
                                data-max-height="${mediaItem.height }" 
                                data-original-src="${mediaItem.src}">

                            <span class="Image__Loader"></span>

                            ${is_video ? '<button type="button" class="Video__PlayButton" aria-label="play">play</button>' : ''}

                            <noscript>
                            <img src="${mediaItem.src}" alt="${mediaItem.alt}">
                            </noscript>
                        </div>
                    </div>`;
				count = count+100;
                is_video && image_position_without_video ++;
                image_position ++; 
       }, 0);
     
    }
  
  	function updateProductVariation(product){
          variantId.dataset.productid = product.id;
          variantId.value = product.variants[0].id;
          console.log(product);
      let formFrag = document.createDocumentFragment();
      let productOptionsFrag = document.createDocumentFragment();
	  let variant;
      let optionSelect = document.createElement('select');
      var sel = document.querySelector('.Popover__Value.is-selected');
      
      product.options.forEach(option => {
        optionSelect.id = `product-select-${product.id}`;
        optionSelect.setAttribute('name', 'id');
        optionSelect.setAttribute('data-productid', product.id);
        optionSelect.setAttribute('title', 'Variant');
		
      })
      
      product.variants.forEach(newProductVariant => {
        let optionElement = document.createElement('option');
        optionElement.value = newProductVariant.id;
        optionElement.innerHTML = newProductVariant.title;
        optionElement.setAttribute('data-stock', '');
        optionSelect.appendChild(optionElement);

      })
      formFrag.appendChild(optionSelect);
      
      sectionContainer.querySelectorAll('[data-product-id]').forEach(element => {
        element.setAttribute('data-product-id', product.id);
      })
      
  	}
  
  	function updateProductUrl(product){
      if (location.href.indexOf("/products") > -1) {
        history.pushState({}, "", product.handle);
      } else {
        history.pushState({}, "", `/products/${product.handle}`);
      }
    }
  
  
  	function updateProductReview(product){
      
	  var settings = {
          'cache': false,
          'dataType': "jsonp",
          "async": true,
          "crossDomain": true,
          "url": "https://productreviews.shopifycdn.com/proxy/v4/reviews/product?callback=productCallback"+product.id+"&product_id="+product.id+"&version=v4&shop=drinkwithco.myshopify.com",
          "method": "GET",
          "headers": {
              "accept": "application/json",
              "Access-Control-Allow-Origin":"*"
          }
      }

      $.ajax(settings).done(function (response) {
        $('.spr-content').html('');
        $('.spr-content').append(response.reviews);
        $('.spr-content').append('<div class="spr-form" id="form_'+product.id+'" style="display: none">'+response.form+'</div>');
      	let myArray = response.aggregate_rating.split("reviewCount");
        let myArray1 = myArray[1].split("ratingValue");
        let suffix = myArray1[0].match(/\d+/); // 123456
        $('.text--light').html('('+suffix+')');
        $('.spr-pagination-next').show();
        $('.spr-pagination-next a:first').attr('data-product-id',product.id);
        $('.spr-pagination-next a:first').attr('data-page',2);
      });
  	}
  
    function editImgURL(url, size) {
        if (url !== undefined){
          url = url.replace(/_\d*x\./, ".");
          url = url.replaceAll(".jpeg", "_" + size + "x.jpeg");
          url = url.replaceAll(".jpg", "_" + size + "x.jpg");
          url = url.replaceAll(".png", "_" + size + "x.png");
          url = url.replaceAll(".gif", "_" + size + "x.gif");
          return url
        }
    }
  
    productVariants.forEach(product => {
        product.addEventListener('click', manageProductVariants);
    });

    //Actions

    //Tests
</script>